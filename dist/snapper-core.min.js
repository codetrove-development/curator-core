!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SnapperCore=e():t.SnapperCore=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.r(e);var o=function(t){return"[object Object]"===Object.prototype.toString.call(t)},r=function(t){return void 0!==t&&null!=t},s={cloneProperties:function t(e,i){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!r)return s=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},o=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),o.forEach(function(e){n(t,e,i[e])})}return t}({},e);for(var d in e)i.indexOf(d)>-1&&(o(e[i])?t(e,i,r,s):s[d]=e[d]);return s},isPureObject:o,setDefaults:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);return t},getRelativePosition:function(t,e){var i=_absolutePosition(e),n=_absolutePosition(t);return{top:n.top-i.top,left:n.left-i.left}},parseBoolean:function(t,e){if(!r(e))throw"snapper.parseBoolean can not be called without a default value provided";return r(t)?"true"===(t=t.toString().toLowerCase().trim())||"false"!==t&&e:e},objIsInArray:function(t,e,i){for(var n=e[i],o=0;o<t.length;o++)if(t[o][i]===n)return!0;return!1},isDefined:r,absolutePosition:function(t){var e=t.getBoundingClientRect(),i=getBody(t),n=window.pageYOffset||i.scrollTop,o=window.pageXOffset||i.scrollLeft,r=i.clientTop||0,s=i.clientLeft||0;return{top:Math.round(e.top+n-r),left:Math.round(e.left+o-s)}},getInnerSize:function(t){var e=window.getComputedStyle?getComputedStyle(t,null):t.currentStyle,i=t.clientWidth;return{height:t.clientHeight-parseInt(e.paddingTop)-parseInt(e.paddingBottom),width:i-parseInt(e.paddingLeft)-parseInt(e.paddingRight)}}},d={flex:"flex",fixed:"fixed"},u={none:"none",x:"x",y:"y",both:"both"},a={x:0,y:0,width:1,height:1,classes:[],glued:!1,visible:!0,canResize:!0,displayResize:!0,position:{topPx:0,leftPx:0,topPct:0,leftPct:0,widthPx:0,heightPx:0,widthPct:0,heightPct:0,ending:"px"},meta:{isDragging:!1,pseudo:!1}},h={position:"absolute",border:"2px dashed grey",zIndex:-1},g={gridColumns:12,gridRows:12,width:"100%",height:"100%",itemClassName:"grid-item",classes:[],renderMode:d.flex,stickyElements:!0,itemsCanResizeGrid:!0,resizeGridDirections:u.y,useTransition:!0,transitionDuration:600,onTransitionComplete:function(t,e,i){},onAllTransitionsComplete:function(t,e,i){},resizeClassName:"snap-resize-handle",enableCSS3:!0,algorithm:null};function l(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){f(t,e,i[e])})}return t}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function m(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}i.d(e,"renderModeType",function(){return d}),i.d(e,"resizeOptions",function(){return u}),i.d(e,"defaultItemOptions",function(){return a}),i.d(e,"defaultGridOptions",function(){return g});e.default={getItemStyles:function(){return{boxSizing:"border-box",position:"absolute"}},getItemClasses:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=m(t.classes).concat([t.itemClassName]);return t.glued&&e.push("snapper-glued"),e},getEmptyGrid:function(t){for(var e=[],i=0;i<t;i++)e.push([]);return e},getItemPosition:function(t,e,i,n,o,r,s,u,a){return a===d.flex?c({},this.getItemPositionPixels(t,e,i,n,o,r,s,u),this.getItemPositionPercentages(t,e,i,n,o,r,s,u)):this.getItemPositionPixels(t,e,i,n,o,r,s,u)},getItemPositionPercentages:function(t,e,i,n,o,r,s,d){var u=Math.floor(t/n),a=Math.floor(e/i),h=t-u*n,g=e-a*i,l=49/t/100,c=49/e/100,f=Math.min(s,h),m=Math.min(o+s,h)-f,p=Math.min(d,g);return{leftPct:100*(s*u+f)/t+l,widthPct:100*(o*u+m)/t+l,topPct:100*(d*a+p)/e+c,heightPct:100*(r*a+(Math.min(r+d,g)-p))/e+c,ending:"%"}},getItemPositionPixels:function(t,e,i,n,o,r,s,d){var u=Math.floor(t/n),a=Math.floor(e/i),h=t-u*n,g=e-a*i,l=Math.min(s,h),c=Math.min(o+s,h)-l,f=Math.min(d,g);return{widthPx:u*o+c,heightPx:a*r+(Math.min(r+d,g)-f),topPx:a*d+f,leftPx:u*s+l,ending:"px"}},updateMovedItem:function(t,e,i){var n=t.newX,o=t.newY,r=t.newWidth,s=t.newHeight,d=e.gridWidth,u=e.gridHeight,a=e.gridRows,h=e.gridColumns,g=i.renderMode,l=c({},t);if(!r||!s)return console.error("Item ".concat(key," does not have a newWidth or newHeight value. Unable to correctly resize item")),t;l.x=n,l.y=o,l.width=r,l.height=s;var f=this.getItemPosition(d,u,a,h,l.width,l.height,l.x,l.y,g),m=this.getItemPositionStyles(i,l.styles,f);return l.position=c({},f),l.styles=c({},m),l},updateGridWithMovedItems:function(t,e){for(var i in e){var n=e[i];this.updateGridWithItemMovement(t,n,n.x,n.y,n.width,n.height)}},getUpdatedMovedItems:function(t,e,i,n,o,r,s,d){var u=this;return t.forEach(function(t){var a=u.updateMovedItem(t,s,d);if(key===e){var h=c({},a.position,{ending:"px",topPx:i,leftPx:n,widthPx:o,heightPx:r}),g=u.getItemPositionStyles(d,a.styles,h);a.position=c({},h),a.styles=c({},g)}return a})},getUpdatedGridSizeItems:function(t,e,i){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=e.renderMode,s=i.gridRows,d=i.gridColumns,u=i.gridHeight,a=i.gridWidth;return t.map(function(t){if(!(o.indexOf(t.id)>-1)){var i=n.getItemPosition(a,u,s,d,t.width,t.height,t.x,t.y,r);return c({},t,{position:i,styles:n.getItemPositionStyles(e,t.styles,i)})}})},getGridBoundaries:function(t){return{leftBoundary:0,rightBoundary:t.gridWidth,topBoundary:0,bottomBoundary:t.gridHeight}},getItemSizing:function(t,e){var i=e.gridWidth,n=e.gridHeight,o=t.width,r=t.height;return{itemWidthPx:o*(i/gridColumns),itemHeightPx:r*(n/gridRows)}},calculateGridMatrixSize:function(t,e,i){var n=e.itemsCanResizeGrid,o=e.resizeGridDirections,r=i.gridRows,s=i.gridColumns,d=n&&"y"!==o,u=n&&"x"!==o;if(!d&&!u)return{rows:r,columns:s};var a=0,h=0;return t.forEach(function(t){var e=t.x+t.width,i=t.y+t.height;e>h&&(h=e),i>a&&(a=i)}),{rows:u?Math.max(a,r):r,columns:d?Math.max(h,s):s}},calculateGridSize:function(t,e,i,n){var o=e.gridRows,r=e.gridColumns;return{newGridWidth:t.widthPx/r*n,newGridHeight:t.heightPx/o*i}},calculateMovementChange:function(t,e,i,n){var o=e.itemsCanResizeGrid,r=o&&"y"!==e.resizeGridDirections,s=o&&"x"!==e.resizeGridDirections,d=i.widthPx/e.gridColumns,u=i.heightPx/e.gridRows,a=n.currentMouseX-n.initialMouseX,h=n.currentMouseY-n.initialMouseY,g=n.initialLeft+a,l=n.initialTop+h,c=Math.round(g/d),f=Math.round(l/u);return c<0?c=0:c+1>e.gridColumns&&!r&&(c=e.gridColumns-1),f<0?f=0:f+1>e.gridRows&&!s&&(f=e.gridRows-1),{newX:c,newY:f,newLeftPx:g,newTopPx:l}},calculateResizeChange:function(t,e,i,n){var o=i.widthPx/e.gridColumns,r=i.heightPx/e.gridRows,s=n.currentMouseX-n.initialMouseX,d=n.currentMouseY-n.initialMouseY,u=n.initialWidth+s,a=n.initialHeight+d,h=Math.round(u/o),g=Math.round(a/r);return u<o&&(h=1,u=o),a<r&&(g=1,a=r),{newWidthPx:u,newHeightPx:a,newWidth:h,newHeight:g,newLeftPx:t.position.leftPx,newTopPx:t.position.topPx}},calculatePositionChange:function(t,e){var i=e.gridSizing,n=e.gridOptions,o=i.widthPx/n.gridColumns,r=i.heightPx/n.gridRows;return{newWidthPx:Math.round(o*t.width),newHeightPx:Math.round(r*t.height),newLeftPx:Math.round(o*t.x),newTopPx:Math.round(r*t.y),newX:t.x,newY:t.y,newWidth:t.width,newHeight:t.height}},getNoMovementResult:function(t,e,i){var n=c({},e,{position:c({},e.position,{ending:"px",topPx:i.newTopPx,leftPx:i.newLeftPx,widthPx:i.newWidthPx,heightPx:i.newHeightPx})}),o=t.items.map(function(t){return t.id==n.id?n:t});return{success:!0,grid:t.grid,updatedItems:o,targetItem:n,gridSizing:t.gridSizing,movementChange:i,itemsMoved:!1}},itemHasMoved:function(t,e){return e.newX!=t.x||e.newY!=t.y},itemHasResized:function(t,e){return e.newWidth!==t.width||e.newHeight!==t.height},checkProposedGridSizing:function(t,e,i){var n=t.gridOptions,o=n.resizeGridDirections!==u.y,r=n.resizeGridDirections!==u.x;if(!o&&e!==n.gridColumns||n.gridColumns<1)throw"Invalid grid column proposition from algorithm";if(!r&&i!==n.gridRows||n.gridRows<1)throw"Invalid grid row proposition from algorithm"},getPlaceholderStyles:function(t){return c({},h,{left:"".concat(t.leftPx,"px"),top:"".concat(t.topPx,"px"),width:"".concat(t.widthPx,"px"),height:"".concat(t.heightPx,"px")})},addItemToGrid:function(t,e){var i={newX:t.x,newY:t.y,newWidth:t.width,newHeight:t.height,newTopPx:t.position.topPx,newLeftPx:t.position.leftPx,newWidthPx:t.position.widthPx,newHeightPx:t.position.heightPx};return this.onItemMovement(t,e,i)},movementIsWithinBounds:function(t,e){var i=e.gridColumns,n=e.gridRows,o=e.itemsCanResizeGrid,r=e.resizeGridDirections,s=t.newX,d=t.newY,u=t.newWidth,a=t.newHeight;return(o&&"y"!==r||s+u<=i)&&(o&&"x"!==r||d+a<=n)},onItemMovement:function(t,e,i){var n=this,o=e.gridOptions.renderMode,r=e.gridOptions,s=this.getNoMovementResult(e,t,i),d=c({},t);if(!this.movementIsWithinBounds(i,r))return s;var u=r.algo.run(e,d,i.newX,i.newY,i.newWidth,i.newHeight);if(!u.success)return s;var a=u.gridColumns!==r.gridColumns||u.gridRows!==r.gridRows,h=e.gridSizing.widthPx,g=e.gridSizing.heightPx;if(a){this.checkProposedGridSizing(e,u.gridColumns,u.gridRows);var l=this.calculateGridSize(e.gridSizing,r,u.gridRows,u.gridColumns);h=l.newGridWidth,g=l.newGridHeight}var f=Object.keys(u.itemsToMove).map(function(t){var e=u.itemsToMove[t],s=n.getItemPosition(h,g,u.gridRows,u.gridColumns,e.width,e.height,e.x,e.y,o);if(e.id===d.id){var a=n.getPlaceholderStyles(s);e.meta=c({},e.meta,{placeholderStyles:a}),e.position=c({},e.position,{ending:"px",topPx:i.newTopPx,leftPx:i.newLeftPx,widthPx:i.newWidthPx,heightPx:i.newHeightPx}),e.styles=n.getItemPositionStyles(r,e.styles,e.position),console.log(e.styles)}else e.position=s,e.styles=n.getItemPositionStyles(r,e.styles,s);return e});return{success:u.success,grid:e.grid,updatedItems:f,itemsMoved:Object.keys(u.itemsToMove).length>1,targetItem:d,movementChange:i,gridSizing:{gridRows:u.gridRows,gridColumns:u.gridColumns,heightPx:g,widthPx:h}}},onItemPositionChanged:function(t,e,i){var n=this.calculatePositionChange(t,i);return this.positionHasChanged(t,e)?this.onItemMovement(e,i,n):this.getNoMovementResult(i,e,n)},positionHasChanged:function(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height},onItemDragStart:function(t){if(t.glued)return{item:t,success:!1};var e=this.getPlaceholderStyles(t.position);return{item:c({},t,{meta:c({},t.meta,{isDragging:!0,placeholderStyles:e})}),success:!0}},onItemDrag:function(t,e,i){var n=c({},this.calculateMovementChange(t,e.gridOptions,e.gridSizing,i),{newWidth:t.width,newHeight:t.height,newWidthPx:t.position.widthPx,newHeightPx:t.position.heightPx});return!t.meta.isDragging||t.glued?this.getNoMovementResult(e,t,n):this.itemHasMoved(t,n)?this.onItemMovement(t,e,n):this.getNoMovementResult(e,t,n)},onItemDragStop:function(t,e,i,n,o,r){var s=t.width,d=t.height,u=t.x,a=t.y,h=o.gridRows,g=o.gridColumns,l=o.renderMode,f=c({},t.meta,{isDragging:!1}),m=this.getItemPosition(i,n,h,g,s,d,u,a,l);return c({},t,{position:m,styles:this.getItemPositionStyles(o,t.styles,m),meta:f})},onItemResizeStart:function(t){return t.glued?{item:t,success:!1}:{item:c({},t,{meta:c({},t.meta,{isResizing:!0})}),success:!0}},onItemResize:function(t,e,i){var n=c({},this.calculateResizeChange(t,e.gridOptions,e.gridSizing,i),{newX:t.x,newY:t.y,newLeftPx:t.position.leftPx,newTopPx:t.position.topPx});return!t.meta.isResizing||t.glued?this.getNoMovementResult(e,t,n):this.itemHasResized(t,n)?this.onItemMovement(t,e,n):this.getNoMovementResult(e,t,n)},onItemResizeStop:function(t,e,i,n,o,r){var s=t.width,d=t.height,u=t.x,a=t.y,h=o.gridRows,g=o.gridColumns,l=o.renderMode,f=c({},t.meta,{isResizing:!1}),m=this.getItemPosition(i,n,h,g,s,d,u,a,l);return c({},t,{position:m,styles:this.getItemPositionStyles(o,t.styles,m),meta:f})},updateGridWithItemMovement:function(t,e,i,n,o,r){var s=e.id,d=e.x,u=e.y,a=e.width,h=e.height;this.ensureGridHasRow(t,u),this.setGridWithValue(t,s,i,n,o,r,void 0,!1),this.setGridWithValue(t,s,d,u,a,h,e,!0)},updateGridWithItem:function(t,e){var i=e.id,n=e.x,o=e.y,r=e.width,s=e.height;this.setGridWithValue(t,i,n,o,r,s,e,!0)},removeGridItem:function(t,e,i,n,o){var r=this,s=i.id,d=i.x,u=i.y,a=i.width,h=i.height,g=o.widthPx,l=o.heightPx,f=n.renderMode;this.ensureGridHasRow(e,u),this.setGridWithValue(e,s,d,u,a,h,void 0,!0);var m=n.algo.onGridItemRemoved(i,e,n);return{updatedItems:t.map(function(t){var e=m.find(function(e){return e.id===t.id});if(!e)return null;var i=e.x,o=e.y,s=e.width,d=e.height,u=c({},t,{x:i,y:o,width:s,height:d}),a=r.getItemPosition(g,l,n.gridRows,n.gridColumns,s,d,i,o,f);return u.position=a,u.styles=r.getItemPositionStyles(n,u.styles,a),u}).filter(function(t){return null!=t})}},ensureGridHasRow:function(t,e){t[e]||(t[e]=[])},setGridWithValue:function(t,e,i,n,o,r,d){for(var u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],a=n;a<n+r;a++)for(var h=i;h<i+o;h++){var g=t[a][h];s.isDefined(g)&&g.id!=e&&!u||(t[a][h]=d)}},getItemPositionStyles:function(t,e,i){var n=e||{},o=(n.transform,n.left,n.top,l(n,["transform","left","top"]));return"%"===i.ending?c({},o,{left:"".concat(i.leftPct,"%"),top:"".concat(i.topPct,"%"),width:"".concat(i.widthPct,"%"),height:"".concat(i.heightPct,"%")}):t.enableCSS3?c({},o,{width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px"),transform:"translate(".concat(i.leftPx,"px, ").concat(i.topPx,"px)")}):c({},o,{left:"".concat(i.leftPx,"px"),top:"".concat(i.topPx,"px"),width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px")})},getGridXY:function(t,e,i){var n=t.gridWidth,o=t.gridHeight,r=t.gridRows,s=t.gridColumns;return{x:this.getGridPosition(n,i,s),y:this.getGridPosition(o,e,r)}},getGridWH:function(t,e,i,n,o){var r=o.gridRows,s=o.gridColumns;return{width:this.getGridPosition(t,i,s),height:this.getGridPosition(e,n,r)}},getGridPosition:function(t,e,i){return Math.max(1,Math.round(e/t*i))},getBoundaryLimitedSizing:function(t,e,i,n,o,r){var s=r.resizeGridDirections,d=r.itemsCanResizeGrid,a=o.rightBoundary,h=o.bottomBoundary,g=d&&s!==u.x;return{widthPx:d&&s!==u.y?i:Math.min(i,a-t),heightPx:g?n:Math.min(n,h-e)}}}}])});