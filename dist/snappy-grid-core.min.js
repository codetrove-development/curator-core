!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SnappyGridCore=e():t.SnappyGridCore=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var n=function(t){return void 0!==t&&null!=t},o={flex:"flex",fixed:"fixed"},r={none:"none",x:"x",y:"y",both:"both"},s={x:0,y:0,width:1,height:1,classes:[],glued:!1,visible:!0,canResize:!0,displayResize:!0,position:{topPx:0,leftPx:0,topPct:0,leftPct:0,widthPx:0,heightPx:0,widthPct:0,heightPct:0,ending:"px"},meta:{isDragging:!1}},d={position:"absolute",border:"2px dashed grey",zIndex:-1},h={gridColumns:12,gridRows:12,width:"100%",height:"100%",itemClassName:"grid-item",classes:[],renderMode:o.flex,stickyElements:!0,itemsCanResizeGrid:!0,resizeGridDirections:r.y,useTransition:!0,transitionDuration:600,onTransitionComplete:function(t,e,i){},onAllTransitionsComplete:function(t,e,i){},resizeClassName:"snap-resize-handle",enableCSS3:!0,algorithm:null};function u(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){g(t,e,i[e])})}return t}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}i.d(e,"renderModeType",function(){return o}),i.d(e,"resizeOptions",function(){return r}),i.d(e,"defaultItemOptions",function(){return s}),i.d(e,"defaultGridOptions",function(){return h});e.default={getItemStyles:function(){return{boxSizing:"border-box",position:"absolute"}},getItemClasses:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,e=l(t.classes).concat([t.itemClassName]);return t.glued&&e.push("snapper-glued"),e},getEmptyGrid:function(t){for(var e=[],i=0;i<t;i++)e.push([]);return e},getItemPosition:function(t,e,i,n,r,s,d,h,u){return u===o.flex?a({},this.getItemPositionPixels(t,e,i,n,r,s,d,h),this.getItemPositionPercentages(t,e,i,n,r,s,d,h)):this.getItemPositionPixels(t,e,i,n,r,s,d,h)},getItemPositionPercentages:function(t,e,i,n,o,r,s,d){var h=Math.floor(t/n),u=Math.floor(e/i),a=t-h*n,g=e-u*i,l=49/t/100,c=49/e/100,m=Math.min(s,a),f=Math.min(o+s,a)-m,p=Math.min(d,g);return{leftPct:100*(s*h+m)/t+l,widthPct:100*(o*h+f)/t+l,topPct:100*(d*u+p)/e+c,heightPct:100*(r*u+(Math.min(r+d,g)-p))/e+c,ending:"%"}},getItemPositionPixels:function(t,e,i,n,o,r,s,d){var h=Math.floor(t/n),u=Math.floor(e/i),a=t-h*n,g=e-u*i,l=Math.min(s,a),c=Math.min(o+s,a)-l,m=Math.min(d,g);return{widthPx:h*o+c,heightPx:u*r+(Math.min(r+d,g)-m),topPx:u*d+m,leftPx:h*s+l,ending:"px"}},updateMovedItem:function(t,e,i){var n=t.newX,o=t.newY,r=t.newWidth,s=t.newHeight,d=e.gridWidth,h=e.gridHeight,u=e.gridRows,g=e.gridColumns,l=i.renderMode,c=a({},t);if(!r||!s)return console.error("Item ".concat(key," does not have a newWidth or newHeight value. Unable to correctly resize item")),t;c.x=n,c.y=o,c.width=r,c.height=s;var m=this.getItemPosition(d,h,u,g,c.width,c.height,c.x,c.y,l),f=this.getItemPositionStyles(i,c.styles,m);return c.position=a({},m),c.styles=a({},f),c},updateGridWithMovedItems:function(t,e){for(var i in e){var n=e[i];this.updateGridWithItemMovement(t,n,n.x,n.y,n.width,n.height)}},getUpdatedMovedItems:function(t,e,i,n,o,r,s,d){var h=this;return t.forEach(function(t){var u=h.updateMovedItem(t,s,d);if(key===e){var g=a({},u.position,{ending:"px",topPx:i,leftPx:n,widthPx:o,heightPx:r}),l=h.getItemPositionStyles(d,u.styles,g);u.position=a({},g),u.styles=a({},l)}return u})},getUpdatedGridSizeItems:function(t,e,i){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=e.renderMode,s=i.gridRows,d=i.gridColumns,h=i.gridHeight,u=i.gridWidth;return t.map(function(t){if(!(o.indexOf(t.id)>-1)){var i=n.getItemPosition(u,h,s,d,t.width,t.height,t.x,t.y,r);return a({},t,{position:i,styles:n.getItemPositionStyles(e,t.styles,i)})}})},getGridBoundaries:function(t){return{leftBoundary:0,rightBoundary:t.gridWidth,topBoundary:0,bottomBoundary:t.gridHeight}},getItemSizing:function(t,e){var i=e.gridWidth,n=e.gridHeight,o=t.width,r=t.height;return{itemWidthPx:o*(i/gridColumns),itemHeightPx:r*(n/gridRows)}},calculateGridMatrixSize:function(t,e,i){var n=e.itemsCanResizeGrid,o=e.resizeGridDirections,r=i.gridRows,s=i.gridColumns,d=n&&"y"!==o,h=n&&"x"!==o;if(!d&&!h)return{rows:r,columns:s};var u=0,a=0;return t.forEach(function(t){var e=t.x+t.width,i=t.y+t.height;e>a&&(a=e),i>u&&(u=i)}),{rows:h?Math.max(u,r):r,columns:d?Math.max(a,s):s}},calculateGridSize:function(t,e,i,n){var o=e.gridRows,r=e.gridColumns;return{newGridWidth:t.widthPx/r*n,newGridHeight:t.heightPx/o*i}},calculateMovementChange:function(t,e,i,n){var o=e.itemsCanResizeGrid,r=o&&"y"!==e.resizeGridDirections,s=o&&"x"!==e.resizeGridDirections,d=i.widthPx/e.gridColumns,h=i.heightPx/e.gridRows,u=n.currentMouseX-n.initialMouseX,a=n.currentMouseY-n.initialMouseY,g=n.initialLeft+u,l=n.initialTop+a,c=Math.round(g/d),m=Math.round(l/h);return c<0?c=0:c+1>e.gridColumns&&!r&&(c=e.gridColumns-1),m<0?m=0:m+1>e.gridRows&&!s&&(m=e.gridRows-1),{newX:c,newY:m,newLeftPx:g,newTopPx:l}},calculateResizeChange:function(t,e,i,n){var o=i.widthPx/e.gridColumns,r=i.heightPx/e.gridRows,s=n.currentMouseX-n.initialMouseX,d=n.currentMouseY-n.initialMouseY,h=n.initialWidth+s,u=n.initialHeight+d,a=Math.round(h/o),g=Math.round(u/r);return h<o&&(a=1,h=o),u<r&&(g=1,u=r),{newWidthPx:h,newHeightPx:u,newWidth:a,newHeight:g,newLeftPx:t.position.leftPx,newTopPx:t.position.topPx}},calculatePositionChange:function(t,e){var i=e.gridSizing,n=e.gridOptions,o=i.widthPx/n.gridColumns,r=i.heightPx/n.gridRows;return{newWidthPx:Math.round(o*t.width),newHeightPx:Math.round(r*t.height),newLeftPx:Math.round(o*t.x),newTopPx:Math.round(r*t.y),newX:t.x,newY:t.y,newWidth:t.width,newHeight:t.height}},getNoMovementResult:function(t,e,i){var n=a({},e,{position:a({},e.position,{ending:"px",topPx:i.newTopPx,leftPx:i.newLeftPx,widthPx:i.newWidthPx,heightPx:i.newHeightPx})}),o=t.items.map(function(t){return t.id==n.id?n:t});return{success:!0,grid:t.grid,updatedItems:o,targetItem:n,gridSizing:t.gridSizing,movementChange:i,itemsMoved:!1}},itemHasMoved:function(t,e){return e.newX!=t.x||e.newY!=t.y},itemHasResized:function(t,e){return e.newWidth!==t.width||e.newHeight!==t.height},checkProposedGridSizing:function(t,e,i){var n=t.gridOptions,o=n.resizeGridDirections!==r.y,s=n.resizeGridDirections!==r.x;if(!o&&e!==n.gridColumns||n.gridColumns<1)throw"Invalid grid column proposition from algorithm";if(!s&&i!==n.gridRows||n.gridRows<1)throw"Invalid grid row proposition from algorithm"},getPlaceholderStyles:function(t){return a({},d,{left:"".concat(t.leftPx,"px"),top:"".concat(t.topPx,"px"),width:"".concat(t.widthPx,"px"),height:"".concat(t.heightPx,"px")})},addItemToGrid:function(t,e){var i={newX:t.x,newY:t.y,newWidth:t.width,newHeight:t.height,newTopPx:t.position.topPx,newLeftPx:t.position.leftPx,newWidthPx:t.position.widthPx,newHeightPx:t.position.heightPx};return this.onItemMovement(t,e,i)},movementIsWithinBounds:function(t,e){var i=e.gridColumns,n=e.gridRows,o=e.itemsCanResizeGrid,r=e.resizeGridDirections,s=t.newX,d=t.newY,h=t.newWidth,u=t.newHeight;return(o&&"y"!==r||s+h<=i)&&(o&&"x"!==r||d+u<=n)},onItemMovement:function(t,e,i){var n=this,o=e.gridOptions.renderMode,r=e.gridOptions,s=this.getNoMovementResult(e,t,i),d=a({},t);if(!this.movementIsWithinBounds(i,r))return s;var h=r.algo.run(e,d,i.newX,i.newY,i.newWidth,i.newHeight);if(!h.success)return s;var u=h.gridColumns!==r.gridColumns||h.gridRows!==r.gridRows,g=e.gridSizing.widthPx,l=e.gridSizing.heightPx;if(u){this.checkProposedGridSizing(e,h.gridColumns,h.gridRows);var c=this.calculateGridSize(e.gridSizing,r,h.gridRows,h.gridColumns);g=c.newGridWidth,l=c.newGridHeight}var m=Object.keys(h.itemsToMove).map(function(t){var e=h.itemsToMove[t],s=n.getItemPosition(g,l,h.gridRows,h.gridColumns,e.width,e.height,e.x,e.y,o);if(e.id===d.id){var u=n.getPlaceholderStyles(s);e.meta=a({},e.meta,{placeholderStyles:u}),e.position=a({},e.position,{ending:"px",topPx:i.newTopPx,leftPx:i.newLeftPx,widthPx:i.newWidthPx,heightPx:i.newHeightPx}),e.styles=n.getItemPositionStyles(r,e.styles,e.position),console.log(e.styles)}else e.position=s,e.styles=n.getItemPositionStyles(r,e.styles,s);return e});return{success:h.success,grid:e.grid,updatedItems:m,itemsMoved:Object.keys(h.itemsToMove).length>1,targetItem:d,movementChange:i,gridSizing:{gridRows:h.gridRows,gridColumns:h.gridColumns,heightPx:l,widthPx:g}}},onItemPositionChanged:function(t,e,i){var n=this.calculatePositionChange(t,i);return this.positionHasChanged(t,e)?this.onItemMovement(e,i,n):this.getNoMovementResult(i,e,n)},positionHasChanged:function(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height},onItemDragStart:function(t){if(t.glued)return{item:t,success:!1};var e=this.getPlaceholderStyles(t.position);return{item:a({},t,{meta:a({},t.meta,{isDragging:!0,placeholderStyles:e})}),success:!0}},onItemDrag:function(t,e,i){var n=a({},this.calculateMovementChange(t,e.gridOptions,e.gridSizing,i),{newWidth:t.width,newHeight:t.height,newWidthPx:t.position.widthPx,newHeightPx:t.position.heightPx});return!t.meta.isDragging||t.glued?this.getNoMovementResult(e,t,n):this.itemHasMoved(t,n)?this.onItemMovement(t,e,n):this.getNoMovementResult(e,t,n)},onItemDragStop:function(t,e,i,n,o,r){var s=t.width,d=t.height,h=t.x,u=t.y,g=o.gridRows,l=o.gridColumns,c=o.renderMode,m=a({},t.meta,{isDragging:!1}),f=this.getItemPosition(i,n,g,l,s,d,h,u,c);return a({},t,{position:f,styles:this.getItemPositionStyles(o,t.styles,f),meta:m})},onItemResizeStart:function(t){return t.glued?{item:t,success:!1}:{item:a({},t,{meta:a({},t.meta,{isResizing:!0})}),success:!0}},onItemResize:function(t,e,i){var n=a({},this.calculateResizeChange(t,e.gridOptions,e.gridSizing,i),{newX:t.x,newY:t.y,newLeftPx:t.position.leftPx,newTopPx:t.position.topPx});return!t.meta.isResizing||t.glued?this.getNoMovementResult(e,t,n):this.itemHasResized(t,n)?this.onItemMovement(t,e,n):this.getNoMovementResult(e,t,n)},onItemResizeStop:function(t,e,i,n,o,r){var s=t.width,d=t.height,h=t.x,u=t.y,g=o.gridRows,l=o.gridColumns,c=o.renderMode,m=a({},t.meta,{isResizing:!1}),f=this.getItemPosition(i,n,g,l,s,d,h,u,c);return a({},t,{position:f,styles:this.getItemPositionStyles(o,t.styles,f),meta:m})},updateGridWithItemMovement:function(t,e,i,n,o,r){var s=e.id,d=e.x,h=e.y,u=e.width,a=e.height;this.ensureGridHasRow(t,h),this.setGridWithValue(t,s,i,n,o,r,void 0,!1),this.setGridWithValue(t,s,d,h,u,a,e,!0)},updateGridWithItem:function(t,e){var i=e.id,n=e.x,o=e.y,r=e.width,s=e.height;this.setGridWithValue(t,i,n,o,r,s,e,!0)},removeGridItem:function(t,e,i,n,o){var r=this,s=i.id,d=i.x,h=i.y,u=i.width,g=i.height,l=o.widthPx,c=o.heightPx,m=n.renderMode;this.ensureGridHasRow(e,h),this.setGridWithValue(e,s,d,h,u,g,void 0,!0);var f=n.algo.onGridItemRemoved(i,e,n);return{updatedItems:t.map(function(t){var e=f.find(function(e){return e.id===t.id});if(!e)return null;var i=e.x,o=e.y,s=e.width,d=e.height,h=a({},t,{x:i,y:o,width:s,height:d}),u=r.getItemPosition(l,c,n.gridRows,n.gridColumns,s,d,i,o,m);return h.position=u,h.styles=r.getItemPositionStyles(n,h.styles,u),h}).filter(function(t){return null!=t})}},ensureGridHasRow:function(t,e){t[e]||(t[e]=[])},setGridWithValue:function(t,e,i,o,r,s,d){for(var h=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=o;u<o+s;u++)for(var a=i;a<i+r;a++){var g=t[u][a];n(g)&&g.id!=e&&!h||(t[u][a]=d)}},getItemPositionStyles:function(t,e,i){var n=e||{},o=(n.transform,n.left,n.top,u(n,["transform","left","top"]));return"%"===i.ending?a({},o,{left:"".concat(i.leftPct,"%"),top:"".concat(i.topPct,"%"),width:"".concat(i.widthPct,"%"),height:"".concat(i.heightPct,"%")}):t.enableCSS3?a({},o,{width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px"),transform:"translate(".concat(i.leftPx,"px, ").concat(i.topPx,"px)")}):a({},o,{left:"".concat(i.leftPx,"px"),top:"".concat(i.topPx,"px"),width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px")})},getGridXY:function(t,e,i){var n=t.gridWidth,o=t.gridHeight,r=t.gridRows,s=t.gridColumns;return{x:this.getGridPosition(n,i,s),y:this.getGridPosition(o,e,r)}},getGridWH:function(t,e,i,n,o){var r=o.gridRows,s=o.gridColumns;return{width:this.getGridPosition(t,i,s),height:this.getGridPosition(e,n,r)}},getGridPosition:function(t,e,i){return Math.max(1,Math.round(e/t*i))},getBoundaryLimitedSizing:function(t,e,i,n,o,s){var d=s.resizeGridDirections,h=s.itemsCanResizeGrid,u=o.rightBoundary,a=o.bottomBoundary,g=h&&d!==r.x;return{widthPx:h&&d!==r.y?i:Math.min(i,u-t),heightPx:g?n:Math.min(n,a-e)}}}}])});