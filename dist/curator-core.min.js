!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CuratorCore=e():t.CuratorCore=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";i.r(e),i.d(e,"renderModeType",function(){return n}),i.d(e,"resizeOptions",function(){return r}),i.d(e,"defaultItemOptions",function(){return o}),i.d(e,"defaultGridOptions",function(){return d}),i.d(e,"defaultPlaceholderStyles",function(){return s});var n={flex:"flex",fixed:"fixed"},r={none:"none",x:"x",y:"y",both:"both"},o={x:0,y:0,width:1,height:1,classes:[],glued:!1,visible:!0,canResize:!0,displayResize:!0,position:{topPx:0,leftPx:0,topPct:0,leftPct:0,widthPx:0,heightPx:0,widthPct:0,heightPct:0,ending:"px"},meta:{isDragging:!1}},s={position:"absolute",border:"2px dashed grey",zIndex:-1},d={gridColumns:12,gridRows:12,width:"100%",height:"100%",itemClassName:"grid-item",classes:[],renderMode:n.flex,stickyElements:!0,itemsCanResizeGrid:!0,resizeGridDirections:r.y,useTransition:!0,transitionDuration:600,onTransitionComplete:function(t,e,i){},onAllTransitionsComplete:function(t,e,i){},resizeClassName:"snap-resize-handle",enableCSS3:!0,algorithm:null}},function(t,e,i){"use strict";i.r(e);e.default={isDefined:function(t){return void 0!==t&&null!=t},objIsInArray:function(t,e,i){var n=e[i];return null!=t.find(function(t){return t[i]===n})}}},function(t,e,i){"use strict";i.r(e);var n=i(1),r=i(0);function o(t,e){if(null==t)return{};var i,n,r=function(t,e){if(null==t)return{};var i,n,r={},o=Object.keys(t);for(n=0;n<o.length;n++)i=o[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)i=o[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){d(t,e,i[e])})}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}e.default={getItemStyles:function(){return{boxSizing:"border-box",position:"absolute"}},getItemClasses:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.defaultItemOptions,e=u(t.classes).concat([t.itemClassName]);return t.glued&&e.push("snapper-glued"),e},getEmptyGrid:function(t){for(var e=[],i=0;i<t;i++)e.push([]);return e},getItemPosition:function(t,e,i,n,o,d,u,h,a){return a===r.renderModeType.flex?s({},this.getItemPositionPixels(t,e,i,n,o,d,u,h),this.getItemPositionPercentages(t,e,i,n,o,d,u,h)):this.getItemPositionPixels(t,e,i,n,o,d,u,h)},getItemPositionPercentages:function(t,e,i,n,r,o,s,d){var u=Math.floor(t/n),h=Math.floor(e/i),a=t-u*n,g=e-h*i,l=49/t/100,c=49/e/100,m=Math.min(s,a),f=Math.min(r+s,a)-m,p=Math.min(d,g);return{leftPct:100*(s*u+m)/t+l,widthPct:100*(r*u+f)/t+l,topPct:100*(d*h+p)/e+c,heightPct:100*(o*h+(Math.min(o+d,g)-p))/e+c,ending:"%"}},getItemPositionPixels:function(t,e,i,n,r,o,s,d){var u=Math.floor(t/n),h=Math.floor(e/i),a=t-u*n,g=e-h*i,l=Math.min(s,a),c=Math.min(r+s,a)-l,m=Math.min(d,g);return{widthPx:u*r+c,heightPx:h*o+(Math.min(o+d,g)-m),topPx:h*d+m,leftPx:u*s+l,ending:"px"}},updateMovedItem:function(t,e,i){var n=t.newX,r=t.newY,o=t.newWidth,d=t.newHeight,u=e.gridWidth,h=e.gridHeight,a=e.gridRows,g=e.gridColumns,l=i.renderMode,c=s({},t);if(!o||!d)return console.error("Item ".concat(key," does not have a newWidth or newHeight value. Unable to correctly resize item")),t;c.x=n,c.y=r,c.width=o,c.height=d;var m=this.getItemPosition(u,h,a,g,c.width,c.height,c.x,c.y,l),f=this.getItemPositionStyles(i,c.styles,m);return c.position=s({},m),c.styles=s({},f),c},updateGridWithMovedItems:function(t,e){for(var i in e){var n=e[i];this.updateGridWithItemMovement(t,n,n.x,n.y,n.width,n.height)}},getUpdatedMovedItems:function(t,e,i,n,r,o,d,u){var h=this;return t.forEach(function(t){var a=h.updateMovedItem(t,d,u);if(key===e){var g=s({},a.position,{ending:"px",topPx:i,leftPx:n,widthPx:r,heightPx:o}),l=h.getItemPositionStyles(u,a.styles,g);a.position=s({},g),a.styles=s({},l)}return a})},getUpdatedGridSizeItems:function(t,e,i){var n=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=e.renderMode,d=i.gridRows,u=i.gridColumns,h=i.gridHeight,a=i.gridWidth;return t.map(function(t){if(!(r.indexOf(t.id)>-1)){var i=n.getItemPosition(a,h,d,u,t.width,t.height,t.x,t.y,o);return s({},t,{position:i,styles:n.getItemPositionStyles(e,t.styles,i)})}})},getGridBoundaries:function(t){return{leftBoundary:0,rightBoundary:t.gridWidth,topBoundary:0,bottomBoundary:t.gridHeight}},getItemSizing:function(t,e){var i=e.gridWidth,n=e.gridHeight,r=t.width,o=t.height;return{itemWidthPx:r*(i/gridColumns),itemHeightPx:o*(n/gridRows)}},calculateGridMatrixSize:function(t,e,i){var n=e.itemsCanResizeGrid,r=e.resizeGridDirections,o=i.gridRows,s=i.gridColumns,d=n&&"y"!==r,u=n&&"x"!==r;if(!d&&!u)return{rows:o,columns:s};var h=0,a=0;return t.forEach(function(t){var e=t.x+t.width,i=t.y+t.height;e>a&&(a=e),i>h&&(h=i)}),{rows:u?Math.max(h,o):o,columns:d?Math.max(a,s):s}},calculateGridSize:function(t,e,i,n){var r=e.gridRows,o=e.gridColumns;return{newGridWidth:t.widthPx/o*n,newGridHeight:t.heightPx/r*i}},calculateMovementChange:function(t,e,i,n){var r=e.itemsCanResizeGrid,o=r&&"y"!==e.resizeGridDirections,s=r&&"x"!==e.resizeGridDirections,d=i.widthPx/e.gridColumns,u=i.heightPx/e.gridRows,h=n.currentMouseX-n.initialMouseX,a=n.currentMouseY-n.initialMouseY,g=n.initialLeft+h,l=n.initialTop+a,c=Math.round(g/d),m=Math.round(l/u);return c<0?c=0:c+1>e.gridColumns&&!o&&(c=e.gridColumns-1),m<0?m=0:m+1>e.gridRows&&!s&&(m=e.gridRows-1),{newX:c,newY:m,newLeftPx:g,newTopPx:l}},calculateResizeChange:function(t,e,i,n){var r=i.widthPx/e.gridColumns,o=i.heightPx/e.gridRows,s=n.currentMouseX-n.initialMouseX,d=n.currentMouseY-n.initialMouseY,u=n.initialWidth+s,h=n.initialHeight+d,a=Math.round(u/r),g=Math.round(h/o);return u<r&&(a=1,u=r),h<o&&(g=1,h=o),{newWidthPx:u,newHeightPx:h,newWidth:a,newHeight:g,newLeftPx:t.position.leftPx,newTopPx:t.position.topPx}},calculatePositionChange:function(t,e){var i=e.gridSizing,n=e.gridOptions,r=i.widthPx/n.gridColumns,o=i.heightPx/n.gridRows;return{newWidthPx:Math.round(r*t.width),newHeightPx:Math.round(o*t.height),newLeftPx:Math.round(r*t.x),newTopPx:Math.round(o*t.y),newX:t.x,newY:t.y,newWidth:t.width,newHeight:t.height}},getNoMovementResult:function(t,e,i){var n=s({},e,{position:s({},e.position,{ending:"px",topPx:i.newTopPx,leftPx:i.newLeftPx,widthPx:i.newWidthPx,heightPx:i.newHeightPx})}),r=t.items.map(function(t){return t.id==n.id?n:t});return{success:!0,grid:t.grid,updatedItems:r,targetItem:n,gridSizing:t.gridSizing,movementChange:i,itemsMoved:!1}},itemHasMoved:function(t,e){return e.newX!=t.x||e.newY!=t.y},itemHasResized:function(t,e){return e.newWidth!==t.width||e.newHeight!==t.height},checkProposedGridSizing:function(t,e,i){var n=t.gridOptions,o=n.resizeGridDirections!==r.resizeOptions.y,s=n.resizeGridDirections!==r.resizeOptions.x;if(!o&&e!==n.gridColumns||n.gridColumns<1)throw"Invalid grid column proposition from algorithm";if(!s&&i!==n.gridRows||n.gridRows<1)throw"Invalid grid row proposition from algorithm"},getPlaceholderStyles:function(t){return s({},r.defaultPlaceholderStyles,{left:"".concat(t.leftPx,"px"),top:"".concat(t.topPx,"px"),width:"".concat(t.widthPx,"px"),height:"".concat(t.heightPx,"px")})},addItemToGrid:function(t,e){var i={newX:t.x,newY:t.y,newWidth:t.width,newHeight:t.height,newTopPx:t.position.topPx,newLeftPx:t.position.leftPx,newWidthPx:t.position.widthPx,newHeightPx:t.position.heightPx};return this.onItemMovement(t,e,i)},movementIsWithinBounds:function(t,e){var i=e.gridColumns,n=e.gridRows,r=e.itemsCanResizeGrid,o=e.resizeGridDirections,s=t.newX,d=t.newY,u=t.newWidth,h=t.newHeight;return(r&&"y"!==o||s+u<=i)&&(r&&"x"!==o||d+h<=n)},onItemMovement:function(t,e,i){var n=this,r=e.gridOptions.renderMode,o=e.gridOptions,d=this.getNoMovementResult(e,t,i),u=s({},t);if(!this.movementIsWithinBounds(i,o))return d;var h=o.algo.run(e,u,i.newX,i.newY,i.newWidth,i.newHeight);if(!h.success)return d;var a=h.gridColumns!==o.gridColumns||h.gridRows!==o.gridRows,g=e.gridSizing.widthPx,l=e.gridSizing.heightPx;if(a){this.checkProposedGridSizing(e,h.gridColumns,h.gridRows);var c=this.calculateGridSize(e.gridSizing,o,h.gridRows,h.gridColumns);g=c.newGridWidth,l=c.newGridHeight}var m=Object.keys(h.itemsToMove).map(function(t){var e=h.itemsToMove[t],d=n.getItemPosition(g,l,h.gridRows,h.gridColumns,e.width,e.height,e.x,e.y,r);if(e.id===u.id){var a=n.getPlaceholderStyles(d);e.meta=s({},e.meta,{placeholderStyles:a}),e.position=s({},e.position,{ending:"px",topPx:i.newTopPx,leftPx:i.newLeftPx,widthPx:i.newWidthPx,heightPx:i.newHeightPx}),e.styles=n.getItemPositionStyles(o,e.styles,e.position),console.log(e.styles)}else e.position=d,e.styles=n.getItemPositionStyles(o,e.styles,d);return e});return{success:h.success,grid:e.grid,updatedItems:m,itemsMoved:Object.keys(h.itemsToMove).length>1,targetItem:u,movementChange:i,gridSizing:{gridRows:h.gridRows,gridColumns:h.gridColumns,heightPx:l,widthPx:g}}},onItemPositionChanged:function(t,e,i){var n=this.calculatePositionChange(t,i);return this.positionHasChanged(t,e)?this.onItemMovement(e,i,n):this.getNoMovementResult(i,e,n)},positionHasChanged:function(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height},onItemDragStart:function(t){if(t.glued)return{item:t,success:!1};var e=this.getPlaceholderStyles(t.position);return{item:s({},t,{meta:s({},t.meta,{isDragging:!0,placeholderStyles:e})}),success:!0}},onItemDrag:function(t,e,i){var n=s({},this.calculateMovementChange(t,e.gridOptions,e.gridSizing,i),{newWidth:t.width,newHeight:t.height,newWidthPx:t.position.widthPx,newHeightPx:t.position.heightPx});return!t.meta.isDragging||t.glued?this.getNoMovementResult(e,t,n):this.itemHasMoved(t,n)?this.onItemMovement(t,e,n):this.getNoMovementResult(e,t,n)},onItemDragStop:function(t,e,i,n,r,o){var d=t.width,u=t.height,h=t.x,a=t.y,g=r.gridRows,l=r.gridColumns,c=r.renderMode,m=s({},t.meta,{isDragging:!1}),f=this.getItemPosition(i,n,g,l,d,u,h,a,c);return s({},t,{position:f,styles:this.getItemPositionStyles(r,t.styles,f),meta:m})},onItemResizeStart:function(t){return t.glued?{item:t,success:!1}:{item:s({},t,{meta:s({},t.meta,{isResizing:!0})}),success:!0}},onItemResize:function(t,e,i){var n=s({},this.calculateResizeChange(t,e.gridOptions,e.gridSizing,i),{newX:t.x,newY:t.y,newLeftPx:t.position.leftPx,newTopPx:t.position.topPx});return!t.meta.isResizing||t.glued?this.getNoMovementResult(e,t,n):this.itemHasResized(t,n)?this.onItemMovement(t,e,n):this.getNoMovementResult(e,t,n)},onItemResizeStop:function(t,e,i,n,r,o){var d=t.width,u=t.height,h=t.x,a=t.y,g=r.gridRows,l=r.gridColumns,c=r.renderMode,m=s({},t.meta,{isResizing:!1}),f=this.getItemPosition(i,n,g,l,d,u,h,a,c);return s({},t,{position:f,styles:this.getItemPositionStyles(r,t.styles,f),meta:m})},updateGridWithItemMovement:function(t,e,i,n,r,o){var s=e.id,d=e.x,u=e.y,h=e.width,a=e.height;this.ensureGridHasRow(t,u),this.setGridWithValue(t,s,i,n,r,o,void 0,!1),this.setGridWithValue(t,s,d,u,h,a,e,!0)},updateGridWithItem:function(t,e){var i=e.id,n=e.x,r=e.y,o=e.width,s=e.height;this.setGridWithValue(t,i,n,r,o,s,e,!0)},removeGridItem:function(t,e,i,n,r){var o=this,d=i.id,u=i.x,h=i.y,a=i.width,g=i.height,l=r.widthPx,c=r.heightPx,m=n.renderMode;this.ensureGridHasRow(e,h),this.setGridWithValue(e,d,u,h,a,g,void 0,!0);var f=n.algo.onGridItemRemoved(i,e,n);return{updatedItems:t.map(function(t){var e=f.find(function(e){return e.id===t.id});if(!e)return null;var i=e.x,r=e.y,d=e.width,u=e.height,h=s({},t,{x:i,y:r,width:d,height:u}),a=o.getItemPosition(l,c,n.gridRows,n.gridColumns,d,u,i,r,m);return h.position=a,h.styles=o.getItemPositionStyles(n,h.styles,a),h}).filter(function(t){return null!=t})}},ensureGridHasRow:function(t,e){t[e]||(t[e]=[])},setGridWithValue:function(t,e,i,r,o,s,d){for(var u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=r;h<r+s;h++)for(var a=i;a<i+o;a++){var g=t[h][a];n.default.isDefined(g)&&g.id!=e&&!u||(t[h][a]=d)}},getItemPositionStyles:function(t,e,i){var n=e||{},r=(n.transform,n.left,n.top,o(n,["transform","left","top"]));return"%"===i.ending?s({},r,{left:"".concat(i.leftPct,"%"),top:"".concat(i.topPct,"%"),width:"".concat(i.widthPct,"%"),height:"".concat(i.heightPct,"%")}):t.enableCSS3?s({},r,{width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px"),transform:"translate(".concat(i.leftPx,"px, ").concat(i.topPx,"px)")}):s({},r,{left:"".concat(i.leftPx,"px"),top:"".concat(i.topPx,"px"),width:"".concat(i.widthPx,"px"),height:"".concat(i.heightPx,"px")})},getGridXY:function(t,e,i){var n=t.gridWidth,r=t.gridHeight,o=t.gridRows,s=t.gridColumns;return{x:this.getGridPosition(n,i,s),y:this.getGridPosition(r,e,o)}},getGridWH:function(t,e,i,n,r){var o=r.gridRows,s=r.gridColumns;return{width:this.getGridPosition(t,i,s),height:this.getGridPosition(e,n,o)}},getGridPosition:function(t,e,i){return Math.max(1,Math.round(e/t*i))},getBoundaryLimitedSizing:function(t,e,i,n,o,s){var d=s.resizeGridDirections,u=s.itemsCanResizeGrid,h=o.rightBoundary,a=o.bottomBoundary,g=u&&d!==r.resizeOptions.y,l=u&&d!==r.resizeOptions.x;return{widthPx:g?i:Math.min(i,h-t),heightPx:l?n:Math.min(n,a-e)}}}}])});